<div id="support_button">
  <%         
      voter_id = session[:user_id] || params[:voter_id]     
      @project = Project.find_by_id(params[:project_id]) unless @project  
  %>
  
  <%= render :partial => "layouts/flash_alert" %>
  
  <% if @project.user.id == voter_id %>
  <% elsif voter_id && @project.is_supporter(voter_id) %>
    <%= submit_to_remote "remove_report", "remove your support", 
        :url =>  {:action => :unvote, :project_id => @project, :voter_id => voter_id }, 
        :update => "support_button",
        :confirm=>"Are you sure you would like to remove your support?",
        :loading => "Element.show('spinner')",
        :complete => "Element.hide('spinner')"  %>
  <% elsif voter_id == nil  %>
    <%= link_to "support this project", :action => :vote, :redirect => "true", :project_id => @project  %>  
  <% else %>
    <%= submit_to_remote "support_project", "support this project", 
        :url => { :action => :vote, :project_id => @project, :voter_id => voter_id },
        :update => "support_button",
        :loading => "Element.show('spinner')",
        :complete => "Element.hide('spinner')" %>    
  <% end %>
  <%= image_tag "spinner.gif", :id => "spinner", :style=> "display:none;height:19px" %>
</div>